# Immer

> 리액트에서 배열이나 객체를 업데이트 해야할 때는 직접 수정해서는 안되고 불변성을 지켜주면서 업데이트를 해야된다. (`spread` 연산자를 사용해 새 객체를 만들거나, `concat`, `filter`, `map` 등의 함수를 사용해 새 배열을 만드는 등..)

* 데이터의 구조가 조금 까다로워지면 불변성을 지켜가면서 새로운 데이터를 생성해내는 코드가 복잡해지기에 `immer` 라이브러리를 사용해서 쉽게 구현할 수 있다.
    ```js
    import produce from "immer";

    const state = {
        number: 1,
        dontChangeMe: 2
    };

    const nextState = produce(state, draft => {
        draft.number += 1;
    });

    console.log(nextState);
    ```

    * 상태를 업데이트 할 때, 불변성을 신경쓰지 않으면서 업데이트를 해주면 `Immer`가 불변성 관리를 대신 해준다.

* `reducer`에서 사용되는 `produce`
    * 항목을 추가, 수정, 제거하고자 하는 값이 배열이나 객체의 깊은 곳에 있다면 `Immer`을 사용하는 것이 좋다.

* Immer와 함수형 업데이트
    * `useState`를 사용하면서 업데이트를 해주는 함수를 넣음으로써 `deps` 배열에 `state`를 넣지 않아도 되었다.
    * 만약 `produce` 함수에 두개의 파라미터를 넣게 되었을 때, 첫번째 파라미터에 넣은 상태를 불변성을 유지하면서 새로운 상태를 만들어준다. 만약 첫번째 파라미터를 생략하고 바로 업데이트 함수를 넣어주게 된다면, 반환 값은 새로운 상태가 아닌 상태를 업데이트 해주는 함수가 된다.

> `Immer`라이브러리가 편한 것은 사실이나, 성능적으로는 사용하지 않은 코드가 더 빠르다. 